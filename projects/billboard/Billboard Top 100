{"files":[{"id":"f38ee61f-d21d-483d-831c-a11fc4bbbaf9","name":"Code","type":"server_js","source":"function doGet() {\n  createTrigger();\n  \n  getBillboardTop100();\n}\n\nfunction createTrigger() {\n  ScriptApp.newTrigger(\"getBillboardTop100\").timeBased().onWeekDay(ScriptApp.WeekDay.SUNDAY).create();\n}\n\nfunction getBillboardTop100() {\n  var url \u003d \"http://www.billboard.com/rss/charts/hot-100\";\n  var txt \u003d UrlFetchApp.fetch(url).getContentText();\n  var doc \u003d XmlService.parse(txt);\n\n  var items \u003d doc.getRootElement().getChild(\"channel\").getChildren(\"item\");\n  \n  var date \u003d items[0].getChild(\"pubDate\").getText().substring(4,17).trim();\n  \n  var spreadsheet \u003d SpreadsheetApp.openById(\"1XKBtFGSlsHXcL7GdrpcNHd9kfXc_jHw19CLz4W7btig\");\n  spreadsheet.insertSheet(date);\n  spreadsheet.setActiveSheet(spreadsheet.getSheetByName(date));\n  spreadsheet.appendRow([\"Position\",\"Song\",\"Artist\",\"Position Last Week\"]);\n  spreadsheet.getDataRange().setFontWeight(\"bold\");\n  \n  for(var i in items) {\n    try {\n      \n      var item  \u003d items[i];\n      \n      var title \u003d item.getChild(\"chart_item_title\").getText();\n      var artist  \u003d item.getChild(\"artist\").getText();\n      var this_week  \u003d item.getChild(\"rank_this_week\").getText();\n      var last_week  \u003d item.getChild(\"rank_last_week\").getText();\n      \n      writeToSpreadsheet(spreadsheet,date,title,artist,this_week,last_week);\n      \n    } catch (e) {\n      Logger.log(e);\n    }\n  }\n  //for(var i\u003d0; i\u003cspreadsheet.getLastColumn(); i++)\n    //spreadsheet.getSheetByName(date).autoResizeColumn(i);\n  spreadsheet.getDataRange().setHorizontalAlignment(\"center\");\n}\n\nfunction writeToSpreadsheet(spreadsheet,date,title,artist,this_week,last_week) {\n  spreadsheet.setActiveSheet(spreadsheet.getSheetByName(date));\n  spreadsheet.appendRow([this_week,title,artist,last_week]);\n}"},{"id":"704663bd-c918-4364-aeb1-a35b8d0d2677","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/New_York\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\"\n}"}]}